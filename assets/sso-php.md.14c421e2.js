import{_ as s,o as a,c as n,Q as l}from"./chunks/framework.cc795e4d.js";const g=JSON.parse('{"title":"SSO PHP","description":"","frontmatter":{},"headers":[],"relativePath":"sso-php.md","filePath":"sso-php.md"}'),p={name:"sso-php.md"},o=l(`<h1 id="sso-php" tabindex="-1">SSO PHP <a class="header-anchor" href="#sso-php" aria-label="Permalink to &quot;SSO PHP&quot;">​</a></h1><p>Petunjuk penggunaan pustaka SSO PHP Universitas Udayana.</p><h2 id="prasyarat" tabindex="-1">Prasyarat <a class="header-anchor" href="#prasyarat" aria-label="Permalink to &quot;Prasyarat&quot;">​</a></h2><ul><li>PHP versi minimal 7.4</li></ul><blockquote><p>Pengujian tutorial dilakukan pada CodeIgniter versi 3.x. Bila Anda mengalami kendala silakan buat <a href="https://github.com/ristekusdi/sso-php/issues" target="_blank" rel="noreferrer">isu di ristekusdi/sso-php</a>.</p></blockquote><h2 id="instalasi" tabindex="-1">Instalasi <a class="header-anchor" href="#instalasi" aria-label="Permalink to &quot;Instalasi&quot;">​</a></h2><p>Gunakan perintah di bawah ini untuk menginstal package ristekusdi/sso-php</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">composer</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">require</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ristekusdi/sso-php</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">composer</span><span style="color:#24292E;"> </span><span style="color:#032F62;">require</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ristekusdi/sso-php</span></span></code></pre></div><p>Setelah diinstal, silakan ambil nilai environment SSO di website IMISSU2 dev atau IMISSU2 dan taruh di file <code>.env</code>.</p><p><strong>Catatan:</strong></p><ol><li>Nilai dari <code>KEYCLOAK_CALLBACK</code> disesuaikan.</li><li>Nilai dari <code>KEYCLOAK_REDIRECT_URL</code> adalah path dari halaman utama aplikasi Anda terlepas diproteksi oleh SSO atau tidak.</li></ol><h2 id="pengaturan" tabindex="-1">Pengaturan <a class="header-anchor" href="#pengaturan" aria-label="Permalink to &quot;Pengaturan&quot;">​</a></h2><p>Pengaturan dibagi menjadi dua bagian yakni <a href="#php">PHP</a> dan <a href="#codeigniter-3-x">CodeIgniter 3.x</a>.</p><h3 id="php" tabindex="-1">PHP <a class="header-anchor" href="#php" aria-label="Permalink to &quot;PHP&quot;">​</a></h3><p>Jalankan perintah berikut untuk menyalin file SSO yang ada di <code>ristekusdi/sso-php</code>.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">./vendor/bin/sso copy:file --type=php</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">./vendor/bin/sso copy:file --type=php</span></span></code></pre></div><p>Atau bila Anda menggunakan terminal bawaan Laragon (CMDER) gunakan perintah di bawah.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">.\\vendor\\bin\\sso copy:file --type=php</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">.\\vendor\\bin\\sso copy:file --type=php</span></span></code></pre></div><p>File SSO yang disalin akan ditaruh di dalam folder <code>sso</code> di direktori root proyek Anda.</p><h3 id="codeigniter-3-x" tabindex="-1">CodeIgniter 3.x <a class="header-anchor" href="#codeigniter-3-x" aria-label="Permalink to &quot;CodeIgniter 3.x&quot;">​</a></h3><ol><li>Jalankan perintah berikut untuk menyalin file SSO yang ada di <code>ristekusdi/sso-php</code>.</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">./vendor/bin/sso copy:file --type=ci3</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">./vendor/bin/sso copy:file --type=ci3</span></span></code></pre></div><p>Atau bila Anda menggunakan terminal bawaan Laragon (CMDER) gunakan perintah di bawah.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">.\\vendor\\bin\\sso copy:file --type=ci3</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">.\\vendor\\bin\\sso copy:file --type=ci3</span></span></code></pre></div><p>File-file SSO yang disalin antara lain:</p><ul><li><code>Webauth.php</code> di folder <code>application/controllers</code>.</li><li><code>Webguard.php</code> di folder <code>application/libraries</code>.</li></ul><ol start="2"><li>Hubungkan controller <code>Webauth.php</code> ke dalam routing di file <code>application/config/routes.php</code>.</li></ol><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">/** Otentikasi */</span></span>
<span class="line"><span style="color:#E1E4E8;">$route[</span><span style="color:#9ECBFF;">&#39;sso/login&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;webauth/login&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">$route[</span><span style="color:#9ECBFF;">&#39;sso/logout&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;webauth/logout&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">$route[</span><span style="color:#9ECBFF;">&#39;sso/callback&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;webauth/callback&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#6A737D;">/** Mengganti session */</span></span>
<span class="line"><span style="color:#E1E4E8;">$route[</span><span style="color:#9ECBFF;">&#39;web-session/change_role_active&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;webauth/change_role_active&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">$route[</span><span style="color:#9ECBFF;">&#39;web-session/change_kv_active&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;webauth/change_kv_active&#39;</span><span style="color:#E1E4E8;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">/** Otentikasi */</span></span>
<span class="line"><span style="color:#24292E;">$route[</span><span style="color:#032F62;">&#39;sso/login&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;webauth/login&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">$route[</span><span style="color:#032F62;">&#39;sso/logout&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;webauth/logout&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">$route[</span><span style="color:#032F62;">&#39;sso/callback&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;webauth/callback&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#6A737D;">/** Mengganti session */</span></span>
<span class="line"><span style="color:#24292E;">$route[</span><span style="color:#032F62;">&#39;web-session/change_role_active&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;webauth/change_role_active&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">$route[</span><span style="color:#032F62;">&#39;web-session/change_kv_active&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;webauth/change_kv_active&#39;</span><span style="color:#24292E;">;</span></span></code></pre></div><ol start="3"><li>Tambahkan <code>webguard</code> sebagai autoload library di direktori <code>application/config/autoload.php</code></li></ol><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// ... artinya autoload library yang sudah pernah Anda tambahkan sebelumnya</span></span>
<span class="line"><span style="color:#E1E4E8;">$autoload[</span><span style="color:#9ECBFF;">&#39;libraries&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">array</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;...&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&#39;webguard&#39;</span><span style="color:#E1E4E8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// ... artinya autoload library yang sudah pernah Anda tambahkan sebelumnya</span></span>
<span class="line"><span style="color:#24292E;">$autoload[</span><span style="color:#032F62;">&#39;libraries&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">array</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;...&#39;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;webguard&#39;</span><span style="color:#24292E;">);</span></span></code></pre></div><ol start="4"><li>Lakukan perubahan nilai pada <code>base_url</code>, <code>composer_autoload</code> dan <code>enable_hooks</code> di file <code>application/config/config.php</code>.</li></ol><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">&lt;?</span><span style="color:#79B8FF;">php</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Auto detection base_url</span></span>
<span class="line"><span style="color:#E1E4E8;">$config[</span><span style="color:#9ECBFF;">&#39;base_url&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> ((</span><span style="color:#79B8FF;">isset</span><span style="color:#E1E4E8;">($_SERVER[</span><span style="color:#9ECBFF;">&#39;HTTPS&#39;</span><span style="color:#E1E4E8;">]) </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> $_SERVER[</span><span style="color:#9ECBFF;">&#39;HTTPS&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;on&quot;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;https&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;http&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">$config[</span><span style="color:#9ECBFF;">&#39;base_url&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">.=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;://&quot;</span><span style="color:#F97583;">.</span><span style="color:#E1E4E8;">$_SERVER[</span><span style="color:#9ECBFF;">&#39;HTTP_HOST&#39;</span><span style="color:#E1E4E8;">];</span></span>
<span class="line"><span style="color:#E1E4E8;">$config[</span><span style="color:#9ECBFF;">&#39;base_url&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">.=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">str_replace</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">basename</span><span style="color:#E1E4E8;">($_SERVER[</span><span style="color:#9ECBFF;">&#39;SCRIPT_NAME&#39;</span><span style="color:#E1E4E8;">]),</span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">,$_SERVER[</span><span style="color:#9ECBFF;">&#39;SCRIPT_NAME&#39;</span><span style="color:#E1E4E8;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Ubah lokasi autoload composer di direktori \`vendor\` pada root project.</span></span>
<span class="line"><span style="color:#E1E4E8;">$config[</span><span style="color:#9ECBFF;">&#39;composer_autoload&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;./vendor/autoload.php&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Aktifkan hooks pada file \`application/config/hooks.php\`.</span></span>
<span class="line"><span style="color:#E1E4E8;">$config[</span><span style="color:#9ECBFF;">&#39;enable_hooks&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">TRUE</span><span style="color:#E1E4E8;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">&lt;?</span><span style="color:#005CC5;">php</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Auto detection base_url</span></span>
<span class="line"><span style="color:#24292E;">$config[</span><span style="color:#032F62;">&#39;base_url&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ((</span><span style="color:#005CC5;">isset</span><span style="color:#24292E;">($_SERVER[</span><span style="color:#032F62;">&#39;HTTPS&#39;</span><span style="color:#24292E;">]) </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> $_SERVER[</span><span style="color:#032F62;">&#39;HTTPS&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;on&quot;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;https&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;http&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">$config[</span><span style="color:#032F62;">&#39;base_url&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">.=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;://&quot;</span><span style="color:#D73A49;">.</span><span style="color:#24292E;">$_SERVER[</span><span style="color:#032F62;">&#39;HTTP_HOST&#39;</span><span style="color:#24292E;">];</span></span>
<span class="line"><span style="color:#24292E;">$config[</span><span style="color:#032F62;">&#39;base_url&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">.=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">str_replace</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">basename</span><span style="color:#24292E;">($_SERVER[</span><span style="color:#032F62;">&#39;SCRIPT_NAME&#39;</span><span style="color:#24292E;">]),</span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">,$_SERVER[</span><span style="color:#032F62;">&#39;SCRIPT_NAME&#39;</span><span style="color:#24292E;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Ubah lokasi autoload composer di direktori \`vendor\` pada root project.</span></span>
<span class="line"><span style="color:#24292E;">$config[</span><span style="color:#032F62;">&#39;composer_autoload&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;./vendor/autoload.php&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Aktifkan hooks pada file \`application/config/hooks.php\`.</span></span>
<span class="line"><span style="color:#24292E;">$config[</span><span style="color:#032F62;">&#39;enable_hooks&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">TRUE</span><span style="color:#24292E;">;</span></span></code></pre></div><ol start="5"><li>Masukkan sintaks berikut untuk mengambil nilai dari file <code>.env</code> dengan perintah <code>$_ENV[&#39;nama_key&#39;]</code> atau <code>$_SERVER[&#39;nama_key&#39;]</code> di file <code>application/config/hooks.php</code>.</li></ol><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$hook[</span><span style="color:#9ECBFF;">&#39;pre_system&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> () {</span></span>
<span class="line"><span style="color:#E1E4E8;">    $dotenv </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Dotenv\\Dotenv</span><span style="color:#F97583;">::</span><span style="color:#B392F0;">createImmutable</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">FCPATH</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    $dotenv</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">load</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$hook[</span><span style="color:#032F62;">&#39;pre_system&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> () {</span></span>
<span class="line"><span style="color:#24292E;">    $dotenv </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Dotenv\\Dotenv</span><span style="color:#D73A49;">::</span><span style="color:#6F42C1;">createImmutable</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">FCPATH</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    $dotenv</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">load</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">};</span></span></code></pre></div><ol start="6"><li>Agar halaman tertentu di dalam suatu proyek dilindungi oleh autentikasi, tambahkan perintah <code>$this-&gt;webguard-&gt;authenticated()</code> ke dalam <code>constructor</code> di suatu controller. Sehingga jika pengguna mengakses halaman tertentu belum terautentikasi maka di arahkan ke halaman login SSO.</li></ol><h2 id="daftar-perintah-auth" tabindex="-1">Daftar Perintah Auth <a class="header-anchor" href="#daftar-perintah-auth" aria-label="Permalink to &quot;Daftar Perintah Auth&quot;">​</a></h2><p>Daftar perintah auth terbagi menjadi dua bagian yakni <a href="#auth-php">PHP</a> dan <a href="#auth-codeigniter-3-x">CodeIgniter 3.x</a>.</p><h3 id="auth-php" tabindex="-1">Auth PHP <a class="header-anchor" href="#auth-php" aria-label="Permalink to &quot;Auth PHP&quot;">​</a></h3><p>Pustaka ini mengimplementasikan <code>Illuminate\\Contracts\\Auth\\Guard</code> dari Laravel sehingga seolah-olah Anda seperti menggunakan Laravel.</p><p>Caranya adalah dengan mengimpor class <code>WebGuard</code> dengan perintah <code>use RistekUSDI\\SSO\\PHP\\Auth\\Guard\\WebGuard;</code> maka Anda akan memiliki beberapa fungsi berikut.</p><p>Berikut perintah-perintah yang digunakan untuk mengakses data pengguna SSO.</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># Methods</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Mengecek apakah pengguna sudah terotentikasi atau login.</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">WebGuard</span><span style="color:#E1E4E8;">())</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Mengecek apakah pengguna adalah &quot;tamu&quot; (belum login atau terotentikasi).</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">WebGuard</span><span style="color:#E1E4E8;">())</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">guest</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Objek pengguna</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">WebGuard</span><span style="color:#E1E4E8;">())</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Attributes</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// sub adalah id user di Keycloak.</span></span>
<span class="line"><span style="color:#6A737D;">// TIDAK DIREKOMENDASIKAN menggunakan atribut ini utk menyimpan nilai.</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">WebGuard</span><span style="color:#E1E4E8;">())</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">sub;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// NIP/NIM - Nama Pengguna</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">WebGuard</span><span style="color:#E1E4E8;">())</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">full_identity;</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">WebGuard</span><span style="color:#E1E4E8;">())</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">name;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Username</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">WebGuard</span><span style="color:#E1E4E8;">())</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">preferred_username;</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">WebGuard</span><span style="color:#E1E4E8;">())</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">username;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// NIP atau NIM</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">WebGuard</span><span style="color:#E1E4E8;">())</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">identifier;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Email</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">WebGuard</span><span style="color:#E1E4E8;">())</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">email;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Daftar peran pengguna dalam suatu aplikasi.</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">WebGuard</span><span style="color:#E1E4E8;">())</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">client_roles;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// id user di Unud.</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">WebGuard</span><span style="color:#E1E4E8;">())</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">unud_identifier_id;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// id tipe pengguna di Unud.</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">WebGuard</span><span style="color:#E1E4E8;">())</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">unud_user_type_id;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// id sso Unud.</span></span>
<span class="line"><span style="color:#6A737D;">// DIREKOMENDASIKAN untuk menggunakan atribut ini untuk menyimpan nilai.</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">WebGuard</span><span style="color:#E1E4E8;">())</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">unud_sso_id;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># Methods</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Mengecek apakah pengguna sudah terotentikasi atau login.</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">WebGuard</span><span style="color:#24292E;">())</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Mengecek apakah pengguna adalah &quot;tamu&quot; (belum login atau terotentikasi).</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">WebGuard</span><span style="color:#24292E;">())</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">guest</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Objek pengguna</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">WebGuard</span><span style="color:#24292E;">())</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Attributes</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// sub adalah id user di Keycloak.</span></span>
<span class="line"><span style="color:#6A737D;">// TIDAK DIREKOMENDASIKAN menggunakan atribut ini utk menyimpan nilai.</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">WebGuard</span><span style="color:#24292E;">())</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">sub;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// NIP/NIM - Nama Pengguna</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">WebGuard</span><span style="color:#24292E;">())</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">full_identity;</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">WebGuard</span><span style="color:#24292E;">())</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">name;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Username</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">WebGuard</span><span style="color:#24292E;">())</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">preferred_username;</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">WebGuard</span><span style="color:#24292E;">())</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">username;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// NIP atau NIM</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">WebGuard</span><span style="color:#24292E;">())</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">identifier;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Email</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">WebGuard</span><span style="color:#24292E;">())</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">email;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Daftar peran pengguna dalam suatu aplikasi.</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">WebGuard</span><span style="color:#24292E;">())</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">client_roles;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// id user di Unud.</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">WebGuard</span><span style="color:#24292E;">())</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">unud_identifier_id;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// id tipe pengguna di Unud.</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">WebGuard</span><span style="color:#24292E;">())</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">unud_user_type_id;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// id sso Unud.</span></span>
<span class="line"><span style="color:#6A737D;">// DIREKOMENDASIKAN untuk menggunakan atribut ini untuk menyimpan nilai.</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">WebGuard</span><span style="color:#24292E;">())</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">unud_sso_id;</span></span></code></pre></div><h3 id="auth-codeigniter-3-x" tabindex="-1">Auth CodeIgniter 3.x <a class="header-anchor" href="#auth-codeigniter-3-x" aria-label="Permalink to &quot;Auth CodeIgniter 3.x&quot;">​</a></h3><p>Berikut daftar perintah auth pada CodeIgniter 3.x</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Methods</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Mengecek apakah ada pengguna telah login via SSO atau tidak.</span></span>
<span class="line"><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">webguard</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Mengembalikan pengguna ke halaman login SSO jika belum login.</span></span>
<span class="line"><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">webguard</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">authenticated</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Objek pengguna</span></span>
<span class="line"><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">webguard</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#6A737D;"># Attributes</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// sub adalah id user di Keycloak.</span></span>
<span class="line"><span style="color:#6A737D;">// TIDAK DIREKOMENDASIKAN menggunakan atribut ini utk menyimpan nilai.</span></span>
<span class="line"><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">webguard</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">sub;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// NIP/NIM - Nama Pengguna</span></span>
<span class="line"><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">webguard</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">full_identity;</span></span>
<span class="line"><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">webguard</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">name;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Username</span></span>
<span class="line"><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">webguard</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">preferred_username;</span></span>
<span class="line"><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">webguard</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">username;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// NIP atau NIM</span></span>
<span class="line"><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">webguard</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">identifier;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Email</span></span>
<span class="line"><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">webguard</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">email;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Daftar peran pengguna dalam suatu aplikasi.</span></span>
<span class="line"><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">webguard</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">client_roles;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// id user di Unud.</span></span>
<span class="line"><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">webguard</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">unud_identifier_id;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// id tipe pengguna di Unud.</span></span>
<span class="line"><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">webguard</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">unud_user_type_id;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// id sso Unud.</span></span>
<span class="line"><span style="color:#6A737D;">// DIREKOMENDASIKAN untuk menggunakan atribut ini untuk menyimpan nilai.</span></span>
<span class="line"><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">webguard</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">unud_sso_id;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Mengecek apakah pengguna memiliki role tertentu atau tidak (role bisa lebih dari 1 dengan format array) dan mengembalikan nilai bertipe boolean.</span></span>
<span class="line"><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">webguard</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">hasRole</span><span style="color:#E1E4E8;">($role);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Mengecek apakah pengguna memiliki permission tertentu atau tidak (permission bisa lebih dari 1 dengan format array) dan mengembalikan nilai booelan.</span></span>
<span class="line"><span style="color:#79B8FF;">$this</span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;">webguard</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">user</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">-&gt;</span><span style="color:#B392F0;">hasPermission</span><span style="color:#E1E4E8;">($permission);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Methods</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Mengecek apakah ada pengguna telah login via SSO atau tidak.</span></span>
<span class="line"><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">webguard</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Mengembalikan pengguna ke halaman login SSO jika belum login.</span></span>
<span class="line"><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">webguard</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">authenticated</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Objek pengguna</span></span>
<span class="line"><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">webguard</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#6A737D;"># Attributes</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// sub adalah id user di Keycloak.</span></span>
<span class="line"><span style="color:#6A737D;">// TIDAK DIREKOMENDASIKAN menggunakan atribut ini utk menyimpan nilai.</span></span>
<span class="line"><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">webguard</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">sub;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// NIP/NIM - Nama Pengguna</span></span>
<span class="line"><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">webguard</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">full_identity;</span></span>
<span class="line"><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">webguard</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">name;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Username</span></span>
<span class="line"><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">webguard</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">preferred_username;</span></span>
<span class="line"><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">webguard</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">username;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// NIP atau NIM</span></span>
<span class="line"><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">webguard</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">identifier;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Email</span></span>
<span class="line"><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">webguard</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">email;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Daftar peran pengguna dalam suatu aplikasi.</span></span>
<span class="line"><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">webguard</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">client_roles;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// id user di Unud.</span></span>
<span class="line"><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">webguard</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">unud_identifier_id;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// id tipe pengguna di Unud.</span></span>
<span class="line"><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">webguard</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">unud_user_type_id;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// id sso Unud.</span></span>
<span class="line"><span style="color:#6A737D;">// DIREKOMENDASIKAN untuk menggunakan atribut ini untuk menyimpan nilai.</span></span>
<span class="line"><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">webguard</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">unud_sso_id;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Mengecek apakah pengguna memiliki role tertentu atau tidak (role bisa lebih dari 1 dengan format array) dan mengembalikan nilai bertipe boolean.</span></span>
<span class="line"><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">webguard</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">hasRole</span><span style="color:#24292E;">($role);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Mengecek apakah pengguna memiliki permission tertentu atau tidak (permission bisa lebih dari 1 dengan format array) dan mengembalikan nilai booelan.</span></span>
<span class="line"><span style="color:#005CC5;">$this</span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;">webguard</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">user</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">-&gt;</span><span style="color:#6F42C1;">hasPermission</span><span style="color:#24292E;">($permission);</span></span></code></pre></div><h2 id="soal-sering-ditanya" tabindex="-1">Soal Sering Ditanya <a class="header-anchor" href="#soal-sering-ditanya" aria-label="Permalink to &quot;Soal Sering Ditanya&quot;">​</a></h2><h5 id="bagaimana-cara-mendapatkan-access-token-dan-refresh-token" tabindex="-1">Bagaimana cara mendapatkan access token dan refresh token? <a class="header-anchor" href="#bagaimana-cara-mendapatkan-access-token-dan-refresh-token" aria-label="Permalink to &quot;Bagaimana cara mendapatkan access token dan refresh token?&quot;">​</a></h5><p>Impor class <code>SSOService</code> dengan perintah <code>use RistekUSDI\\SSO\\PHP\\Services\\SSOService;</code>.</p><p>Gunakan perintah <code>(new SSOService())-&gt;retrieveToken()</code> untuk mendapatkan access token dan refresh token.</p>`,49),e=[o];function t(c,r,y,i,E,d){return a(),n("div",null,e)}const F=s(p,[["render",t]]);export{g as __pageData,F as default};
