<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SSO Laravel | RistekUSDI</title>
    <meta name="description" content="Dokumentasi pustaka karya Ristek USDI.">
    <link rel="stylesheet" href="/assets/style.12c69fbc.css">
    <link rel="modulepreload" href="/assets/app.c828cd1a.js">
    <link rel="modulepreload" href="/assets/sso-laravel.md.0904de07.lean.js">
    
    <script>(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-6b5fd0a9><!--[--><!--]--><!--[--><span tabindex="-1" data-v-45f6ae50></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-45f6ae50> Skip to content </a><!--]--><!----><header class="VPNav no-sidebar" data-v-6b5fd0a9 data-v-0e356168><div class="VPNavBar" data-v-0e356168 data-v-8856f192><div class="container" data-v-8856f192><div class="VPNavBarTitle" data-v-8856f192 data-v-6a6f7ff6><a class="title" href="/" data-v-6a6f7ff6><!----><!--[-->Ristek USDI<!--]--></a></div><div class="content" data-v-8856f192><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-8856f192 data-v-a30758ee><span id="main-nav-aria-label" class="visually-hidden" data-v-a30758ee>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/sso-php.html" data-v-a30758ee data-v-8fba5fa8 data-v-5704c677><!--[-->SSO PHP<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/sso-laravel.html" data-v-a30758ee data-v-8fba5fa8 data-v-5704c677><!--[-->SSO Laravel<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-8856f192 data-v-311055f2><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-311055f2 data-v-781f9d1b data-v-1dda4c9c><span class="check" data-v-1dda4c9c><span class="icon" data-v-1dda4c9c><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-781f9d1b><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-781f9d1b><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-8856f192 data-v-0562f5c0 data-v-8dccea88><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-8dccea88><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-8dccea88><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-8dccea88><div class="VPMenu" data-v-8dccea88 data-v-e73581a2><!----><!--[--><!--[--><!----><div class="group" data-v-0562f5c0><div class="item appearance" data-v-0562f5c0><p class="label" data-v-0562f5c0>Appearance</p><div class="appearance-action" data-v-0562f5c0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-0562f5c0 data-v-781f9d1b data-v-1dda4c9c><span class="check" data-v-1dda4c9c><span class="icon" data-v-1dda4c9c><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-781f9d1b><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-781f9d1b><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-8856f192 data-v-6f008456><span class="container" data-v-6f008456><span class="top" data-v-6f008456></span><span class="middle" data-v-6f008456></span><span class="bottom" data-v-6f008456></span></span></button></div></div></div><!----></header><!----><!----><div class="VPContent" id="VPContent" data-v-6b5fd0a9 data-v-a4c57a06><div class="VPDoc" data-v-a4c57a06 data-v-79ca2460><div class="container" data-v-79ca2460><div class="aside" data-v-79ca2460><div class="aside-curtain" data-v-79ca2460></div><div class="aside-container" data-v-79ca2460><div class="aside-content" data-v-79ca2460><div class="VPDocAside" data-v-79ca2460 data-v-779d834d><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline has-outline" data-v-779d834d data-v-51e5a8ce><div class="content" data-v-51e5a8ce><div class="outline-marker" data-v-51e5a8ce></div><div class="outline-title" data-v-51e5a8ce>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-51e5a8ce><span class="visually-hidden" id="doc-outline-aria-label" data-v-51e5a8ce> Table of Contents for current page </span><ul class="root" data-v-51e5a8ce><!--[--><li style="" data-v-51e5a8ce><a class="outline-link" href="#memasang-nilai-environment" data-v-51e5a8ce>Memasang Nilai Environment</a><!----></li><li style="" data-v-51e5a8ce><a class="outline-link" href="#instalasi" data-v-51e5a8ce>Instalasi</a><!----></li><li style="" data-v-51e5a8ce><a class="outline-link" href="#panduan-peningkatan" data-v-51e5a8ce>Panduan Peningkatan</a><!----></li><li style="" data-v-51e5a8ce><a class="outline-link" href="#konfigurasi-web-guard" data-v-51e5a8ce>Konfigurasi Web Guard</a><!----></li><li style="" data-v-51e5a8ce><a class="outline-link" href="#konfigurasi-web-guard-tingkat-lanjut" data-v-51e5a8ce>Konfigurasi Web Guard - Tingkat Lanjut</a><!----></li><li style="" data-v-51e5a8ce><a class="outline-link" href="#daftar-perintah-auth" data-v-51e5a8ce>Daftar Perintah Auth</a><!----></li><li style="" data-v-51e5a8ce><a class="outline-link" href="#soal-sering-ditanya" data-v-51e5a8ce>Soal Sering Ditanya</a><!----></li><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-779d834d></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-79ca2460><div class="content-container" data-v-79ca2460><!--[--><!--]--><main class="main" data-v-79ca2460><div style="position:relative;" class="vp-doc _sso-laravel" data-v-79ca2460><div><h1 id="sso-laravel" tabindex="-1">SSO Laravel <a class="header-anchor" href="#sso-laravel" aria-hidden="true">#</a></h1><p>Petunjuk penggunaan pustaka SSO Laravel Universitas Udayana.</p><h2 id="memasang-nilai-environment" tabindex="-1">Memasang Nilai Environment <a class="header-anchor" href="#memasang-nilai-environment" aria-hidden="true">#</a></h2><p>Anda akan mendapatkan isian konfigurasi berikut setelah membuat client app dan menyalin environment client app di IMISSU2.</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">SSO_ADMIN_URL=https://your-admin-sso-domain.com</span></span>
<span class="line"><span style="color:#A6ACCD;">SSO_BASE_URL=https://your-sso-domain.com</span></span>
<span class="line"><span style="color:#A6ACCD;">SSO_REALM=master</span></span>
<span class="line"><span style="color:#A6ACCD;">SSO_REALM_PUBLIC_KEY=xxxxxxxxxx</span></span>
<span class="line"><span style="color:#A6ACCD;">SSO_CLIENT_ID=xxxxxxx</span></span>
<span class="line"><span style="color:#A6ACCD;">SSO_CLIENT_SECRET=xxxxxx</span></span>
<span class="line"></span></code></pre></div><p>Isian konfigurasi tersebut dipasang pada file <code>.env</code>.</p><ul><li><code>SSO_ADMIN_URL</code> adalah URL server admin SSO.</li><li><code>SSO_BASE_URL</code> adalah URL server SSO.</li><li><code>SSO_REALM</code> adalah &quot;realm&quot; tempat client app Anda berada yang didapatkan dari IMISSU Dashboard.</li><li><code>SSO_REALM_PUBLIC_KEY</code> adalah realm public key server SSO yang didapatkan dari IMISSU Dashboard.</li><li><code>SSO_CLIENT_ID</code> adalah client id yang didapatkan dari IMISSU Dashboard.</li><li><code>SSO_CLIENT_SECRET</code> adalah client secret yang didapatkan dari IMISSU Dashboard.</li></ul><h2 id="instalasi" tabindex="-1">Instalasi <a class="header-anchor" href="#instalasi" aria-hidden="true">#</a></h2><ol><li>Instal <code>ristekusdi/sso-laravel</code> dengan perintah</li></ol><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;"># Laravel 8 hingga 9</span></span>
<span class="line"><span style="color:#A6ACCD;">composer require ristekusdi/sso-laravel:^2</span></span>
<span class="line"></span></code></pre></div><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;"># Laravel 5.6 hingga 7.x</span></span>
<span class="line"><span style="color:#A6ACCD;">composer require ristekusdi/sso-laravel:^1</span></span>
<span class="line"></span></code></pre></div><h2 id="panduan-peningkatan" tabindex="-1">Panduan Peningkatan <a class="header-anchor" href="#panduan-peningkatan" aria-hidden="true">#</a></h2><h3 id="_2-5-1" tabindex="-1">2.5.1 <a class="header-anchor" href="#_2-5-1" aria-hidden="true">#</a></h3><ol><li>Jalankan perintah berikut untuk memperbaharui versi sso-laravel.</li></ol><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">composer update ristekusdi/sso-laravel</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li>Perbaharui baris kode pada file <code>app/Http/Controllers/SSO/Web/AuthController.php</code> di method <code>callback()</code>.</li></ol><div class="language-diff"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> if (Auth::guard(&#39;imissu-web&#39;)-&gt;validate($token)) {</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;">     $url = config(&#39;sso.web.redirect_url&#39;, &#39;/&#39;);</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;">     return redirect()-&gt;intended($url);</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> } else {</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;">    // For case like user doesn&#39;t have token</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;">    // or user doesn&#39;t have access to certain client app</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;">    throw new CallbackException(&#39;Unauthorized&#39;, 403);</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;"> try {</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;">    Auth::guard(&#39;imissu-web&#39;)-&gt;validate($token);</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;">    $url = config(&#39;sso.web.redirect_url&#39;, &#39;/&#39;);</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;">    return redirect()-&gt;intended($url);</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;"> } catch (\Exception $e) {</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;">    throw new CallbackException($e-&gt;getMessage(), $e-&gt;getCode());</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;"> }</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>Terdapat tambahan atribut baru pada pengguna yakni <code>preferred_username</code>, <code>given_name</code>, dan <code>family_name</code>.</li></ol><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">preferred_username = username</span></span>
<span class="line"><span style="color:#A6ACCD;">given_name = identifier</span></span>
<span class="line"><span style="color:#A6ACCD;">family_name = name</span></span>
<span class="line"></span></code></pre></div><ul><li><p>$credentials = IMISSUWeb::retrieveToken();</p></li><li><p>if (empty($credentials)) {</p></li><li><p>throw new \Exception(&#39;Credentials are empty.&#39;);</p></li><li><p>}</p></li><li><p>$user = IMISSUWeb::getUserProfile($credentials);</p></li><li><p>if (empty($user)) {</p></li><li><p>IMISSUWeb::forgetToken();</p></li><li><p>throw new \Exception(&#39;User not found.&#39;);</p></li><li><p>}</p></li></ul><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">### 2.4.1</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">1. Jalankan perintah berikut untuk memperbaharui versi sso-laravel.</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">```bash</span></span>
<span class="line"><span style="color:#A6ACCD;">composer update ristekusdi/sso-laravel</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><blockquote><p>Pastikan versi ristekusdi/sso-laravel adalah versi 2.4 ke atas.</p></blockquote><ol start="2"><li>Jalankan perintah mengimpor aset-aset yang diperlukan.</li></ol><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">php artisan vendor:publish --tag=sso-laravel-web</span></span>
<span class="line"><span style="color:#A6ACCD;">php artisan vendor:publish --tag=sso-laravel-web-advance</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>Perbaharui <code>model</code> dari provider <code>imissu-web</code> pada file <code>config/auth.php</code>.</li></ol><div class="language-diff"><span class="copy"></span><div class="highlight-lines"><div class="highlighted"> </div><div class="highlighted"> </div><br></div><pre><code><span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;">   &#39;model&#39; =&gt; App\Models\SSO\User::class,</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;">   &#39;model&#39; =&gt; App\Models\SSO\Web\User::class,</span></span>
<span class="line"></span></code></pre></div><ol start="4"><li>Pada file <code>config/sso.php</code> terdapat array dengan key <code>user_attributes</code>. Ini berfungsi bila Anda ingin menambah atribut tambahan pengguna yang berasal dari Keycloak, database atau session aplikasi Anda. Secara bawaan, isian dari array dengan key <code>user_attributes</code> antara lain <code>unud_identifier_id</code>, <code>unud_sso_id</code> dan <code>unud_user_type_id</code>.</li></ol><div class="language-php"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">user_attributes</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// default attributes</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unud_identifier_id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unud_sso_id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">unud_user_type_id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">],</span></span>
<span class="line"></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">INFO</p><p>Pelajari lebih lanjut pada sesi <a href="#konfigurasi-web-guard-tingkat-lanjut">Konfigurasi Web Guard - Tingkat Lanjut</a>!</p></div><ol start="5"><li>Perbaharui nilai <code>guard</code> pada file <code>config/sso.php</code>.</li></ol><div class="language-diff"><span class="copy"></span><div class="highlight-lines"><div class="highlighted"> </div><div class="highlighted"> </div><br></div><pre><code><span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;">   &#39;guard&#39; =&gt; RistekUSDI\SSO\Auth\Guard\WebGuard::class,</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;">   &#39;guard&#39; =&gt; App\Services\Auth\Guard\WebGuard::class,</span></span>
<span class="line"></span></code></pre></div><ol start="6"><li>Daftarkan route <code>sso-web.php</code> dan hapus route <code>sso.php</code> dari file <code>routes/web.php</code>.</li></ol><div class="language-diff"><span class="copy"></span><div class="highlight-lines"><div class="highlighted"> </div><div class="highlighted"> </div><br></div><pre><code><span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;">  require __DIR__.&#39;/sso.php&#39;;</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;">  require __DIR__.&#39;/sso-web.php&#39;;</span></span>
<span class="line"></span></code></pre></div><ol start="7"><li>Pada file <code>config/app.php</code> daftarkan provider <code>WebSession</code> di dalam array <code>providers</code> dan class alias <code>WebSession</code> di dalam array <code>aliases</code>.</li></ol><div class="language-php"><span class="copy"></span><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><div class="highlighted"> </div><br><br></div><pre><code><span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">providers</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// WebSession</span></span>
<span class="line"><span style="color:#A6ACCD;">    App</span><span style="color:#89DDFF;">\</span><span style="color:#A6ACCD;">Providers</span><span style="color:#89DDFF;">\</span><span style="color:#FFCB6B;">WebSessionProvider</span><span style="color:#89DDFF;">::</span><span style="color:#F78C6C;">class</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">],</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aliases</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// WebSession</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">WebSession</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">\</span><span style="color:#A6ACCD;">Facades</span><span style="color:#89DDFF;">\</span><span style="color:#FFCB6B;">WebSession</span><span style="color:#89DDFF;">::</span><span style="color:#F78C6C;">class</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre></div><ol start="8"><li>Impor facade <code>WebSession</code> pada file <code>app/Http/Controllers/SSO/Web/AuthController.php</code> dan tambahkan perintah <code>WebSession::forgetRoleActive()</code> pada baris paling atas di dalam method <code>logout()</code>. Hal ini bertujuan untuk menghapus session <code>role_active</code> yang disimpan oleh Laravel.</li></ol><div class="language-php"><span class="copy"></span><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br></div><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// Import facade WebSession</span></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> </span><span style="color:#A6ACCD;">App</span><span style="color:#89DDFF;">\</span><span style="color:#A6ACCD;">Facades</span><span style="color:#89DDFF;">\</span><span style="color:#A6ACCD;">WebSession</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">AuthController</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Controller</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">logout</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// Forget role active</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">WebSession</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">forgetRoleActive</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//...</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><ol start="9"><li>Daftarkan route <code>web-session.php</code> ke dalam file <code>routes/web.php</code>. Tujuannya untuk mengganti session <code>role_active</code> pengguna.</li></ol><div class="language-php"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">require</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">__DIR__</span><span style="color:#89DDFF;">.&#39;</span><span style="color:#C3E88D;">/web-session.php</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="konfigurasi-web-guard" tabindex="-1">Konfigurasi Web Guard <a class="header-anchor" href="#konfigurasi-web-guard" aria-hidden="true">#</a></h2><ol><li>Impor aset-aset yang diperlukan dengan perintah berikut</li></ol><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">php artisan vendor:publish --tag=sso-laravel-web</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li>Menambah guard dan provider <code>imissu-web</code> yang ada pada file <code>config/auth.php</code>.</li></ol><div class="language-php"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// Tambahkan ini di dalam array dengan key &#39;guards&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">imissu-web</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">driver</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">imissu-web</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">provider</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">imissu-web</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">],</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// Tambahkan ini di dalam array dengan key &#39;providers&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">imissu-web</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">driver</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">imissu-web</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">model</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">\</span><span style="color:#A6ACCD;">Models</span><span style="color:#89DDFF;">\</span><span style="color:#A6ACCD;">SSO</span><span style="color:#89DDFF;">\</span><span style="color:#A6ACCD;">Web</span><span style="color:#89DDFF;">\</span><span style="color:#FFCB6B;">User</span><span style="color:#89DDFF;">::</span><span style="color:#F78C6C;">class</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">],</span></span>
<span class="line"></span></code></pre></div><ol start="4"><li>Daftarkan route <code>sso-web.php</code> ke dalam file <code>routes/web.php</code>. Ini berfungsi untuk menambahkan route SSO (login, callback, logout).</li></ol><div class="language-php"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">require</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">__DIR__</span><span style="color:#89DDFF;">.&#39;</span><span style="color:#C3E88D;">/sso-web.php</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><ol start="5"><li>Untuk melindungi halaman atau URL tertentu (misal /home) dengan otentikasi SSO maka tambahkan middleware <code>imissu-web</code> pada route tersebut.</li></ol><p>Contoh:</p><div class="language-php"><span class="copy"></span><pre><code><span class="line"><span style="color:#FFCB6B;">Route</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/home</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">HomeController@index</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)-&gt;</span><span style="color:#82AAFF;">middleware</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">imissu-web</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div><ol start="6"><li>Aplikasi siap dijalankan dengan perintah <code>php artisan serve --port=&lt;port yang dipasang di IMISSU Dashboard&gt;</code> atau custom domain <code>http://yourapp.test</code> dengan bantuan <a href="https://laragon.org/docs/pretty-urls.html" target="_blank" rel="noopener noreferrer">Laragon</a>.</li></ol><p>Konfigurasi telah selesai. Tetapi, ada kalanya kita memiliki kasus seperti menyisipkan atribut-atribut tambahan seperti <code>role_permissions</code> dan <code>role_active</code>. Atribut <code>role_permissions</code> diambil dari database dan <code>role_active</code> diambil dari session.</p><p>Untuk kasus tersebut kita lanjutkan pada tahap Konfigurasi Web Guard - Tingkat Lanjut.</p><h2 id="konfigurasi-web-guard-tingkat-lanjut" tabindex="-1">Konfigurasi Web Guard - Tingkat Lanjut <a class="header-anchor" href="#konfigurasi-web-guard-tingkat-lanjut" aria-hidden="true">#</a></h2><ol><li>Impor aset-aset yang diperlukan dengan perintah berikut</li></ol><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">php artisan vendor:publish --tag=sso-laravel-web-advance</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li>Perbaharui nilai <code>guard</code> pada file <code>config/sso.php</code>.</li></ol><div class="language-diff"><span class="copy"></span><div class="highlight-lines"><div class="highlighted"> </div><div class="highlighted"> </div><br></div><pre><code><span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;">   &#39;guard&#39; =&gt; RistekUSDI\SSO\Auth\Guard\WebGuard::class,</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;">   &#39;guard&#39; =&gt; App\Services\Auth\Guard\WebGuard::class,</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>Pada file <code>sso.php</code> di folder <code>config</code> tambahkan nilai <code>role_permissions</code> dan <code>role_active</code> pada sebuah array dengan key <code>user_attributes</code>.</li></ol><div class="language-php"><span class="copy"></span><div class="highlight-lines"><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br></div><pre><code><span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">user_attributes</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">role_permissions</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">role_active</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">],</span></span>
<span class="line"></span></code></pre></div><ol start="4"><li>Pada file <code>config/app.php</code> daftarkan provider <code>WebSession</code> di dalam array <code>providers</code> dan class alias <code>WebSession</code> di dalam array <code>aliases</code>.</li></ol><div class="language-php"><span class="copy"></span><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><div class="highlighted"> </div><br><br></div><pre><code><span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">providers</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// WebSession</span></span>
<span class="line"><span style="color:#A6ACCD;">    App</span><span style="color:#89DDFF;">\</span><span style="color:#A6ACCD;">Providers</span><span style="color:#89DDFF;">\</span><span style="color:#FFCB6B;">WebSessionProvider</span><span style="color:#89DDFF;">::</span><span style="color:#F78C6C;">class</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">],</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aliases</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// WebSession</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">WebSession</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">\</span><span style="color:#A6ACCD;">Facades</span><span style="color:#89DDFF;">\</span><span style="color:#FFCB6B;">WebSession</span><span style="color:#89DDFF;">::</span><span style="color:#F78C6C;">class</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre></div><ol start="5"><li>Impor facade <code>WebSession</code> pada file <code>app/Http/Controllers/SSO/Web/AuthController.php</code> dan tambahkan perintah <code>WebSession::forgetRoleActive()</code> pada baris paling atas di dalam method <code>logout()</code>. Hal ini bertujuan untuk menghapus session <code>role_active</code> yang disimpan oleh Laravel.</li></ol><div class="language-php"><span class="copy"></span><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br></div><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// Import facade WebSession</span></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> </span><span style="color:#A6ACCD;">App</span><span style="color:#89DDFF;">\</span><span style="color:#A6ACCD;">Facades</span><span style="color:#89DDFF;">\</span><span style="color:#A6ACCD;">WebSession</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">AuthController</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Controller</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">logout</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// Forget role active</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">WebSession</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">forgetRoleActive</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//...</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><ol start="6"><li>Daftarkan route <code>web-session.php</code> ke dalam file <code>routes/web.php</code>. Tujuannya untuk mengganti session <code>role_active</code> pengguna.</li></ol><div class="language-php"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">require</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">__DIR__</span><span style="color:#89DDFF;">.&#39;</span><span style="color:#C3E88D;">/web-session.php</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><ol start="7"><li>Daftarkan route <code>sso-web-demo.php</code> ke dalam file <code>routes/web.php</code>. Tujuannya untuk demo dari konfigurasi tingkat lanjut.</li></ol><div class="language-php"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">require</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">__DIR__</span><span style="color:#89DDFF;">.&#39;</span><span style="color:#C3E88D;">/sso-web-demo.php</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><ol start="8"><li>Buka halaman <code>http://localhost:&lt;your-port-number&gt;/sso-web-demo</code> untuk melihat hasil dari konfigurasi tingkat lanjut.</li></ol><h2 id="daftar-perintah-auth" tabindex="-1">Daftar Perintah Auth <a class="header-anchor" href="#daftar-perintah-auth" aria-hidden="true">#</a></h2><p>Pustaka ini mengimplementasikan <code>Illuminate\Contracts\Auth\Guard</code> sehingga hampir semua method di sini mengimplementasikan bawaan Laravel Framework.</p><p>Untuk mengakses data pengguna terotentikasi oleh SSO IMISSU gunakan perintah <code>auth(&#39;imissu-web&#39;)-&gt;user()</code>. Isi dari data-data pengguna terotentikasi oleh SSO IMISSU antara lain:</p><ul><li><code>sub</code>.</li><li><code>full_identity</code> dengan format <code>NIP Nama Pengguna</code>.</li><li><code>username</code>.</li><li><code>identifier</code> berupa NIP atau NIM.</li><li><code>name</code>.</li><li><code>email</code>.</li><li><code>roles</code>.</li><li><code>unud_identifier_id</code>.</li><li><code>unud_sso_id</code>.</li><li><code>unud_user_type_id</code>.</li></ul><p>Kemudian, terdapat method-method tambahan dari perintah <code>auth(&#39;imissu-web&#39;)</code>:</p><h5 id="user-roles" tabindex="-1"><code>user()-&gt;roles()</code> <a class="header-anchor" href="#user-roles" aria-hidden="true">#</a></h5><p>Mendapatkan daftar peran pengguna dalam bentuk array.</p><h5 id="user-hasroles-roles" tabindex="-1"><code>user()-&gt;hasRoles($roles)</code> <a class="header-anchor" href="#user-hasroles-roles" aria-hidden="true">#</a></h5><p>Mengecek apakah pengguna memiliki peran tertentu. Nilai <code>$roles</code> bisa berupa string atau array.</p><h5 id="user-permissions" tabindex="-1"><code>user()-&gt;permissions()</code> <a class="header-anchor" href="#user-permissions" aria-hidden="true">#</a></h5><p>Mendapatkan daftar permissions dalam bentuk array yang melekat pada role active pengguna.</p><h5 id="user-haspermission-permissions" tabindex="-1"><code>user()-&gt;hasPermission($permissions)</code> <a class="header-anchor" href="#user-haspermission-permissions" aria-hidden="true">#</a></h5><p>Mengecek apakah pengguna memiliki permissions yang melekat pada role active user. Nilai <code>$permissions</code> bisa berupa string atau array.</p><h5 id="check" tabindex="-1"><code>check()</code> <a class="header-anchor" href="#check" aria-hidden="true">#</a></h5><p>Mengecek apakah pengguna sudah login?</p><h5 id="guest" tabindex="-1"><code>guest()</code> <a class="header-anchor" href="#guest" aria-hidden="true">#</a></h5><p>Mengecek apakah pengguna belum login?</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Anda juga bisa menggunakan <code>Auth::guard(&#39;imissu-web&#39;)</code> sebagai alternatif dari <code>auth(&#39;imissu-web&#39;)</code>.</p></div><h2 id="soal-sering-ditanya" tabindex="-1">Soal Sering Ditanya <a class="header-anchor" href="#soal-sering-ditanya" aria-hidden="true">#</a></h2><h3 id="bagaimana-cara-mendapatkan-access-token-dan-refresh-token" tabindex="-1">Bagaimana cara mendapatkan access token dan refresh token? <a class="header-anchor" href="#bagaimana-cara-mendapatkan-access-token-dan-refresh-token" aria-hidden="true">#</a></h3><p>Ada dua cara untuk mendapatkan access token dan refresh token:</p><ol><li><p>Mengimpor facade <code>IMISSUWeb</code> dengan perintah <code>use RistekUSDI\SSO\Facades\IMISSUWeb;</code>, kemudian jalankan perintah <code>IMISSUWeb::retrieveToken()</code>.</p></li><li><p>Menggunakan session. Gunakan perintah <code>session()-&gt;get(&#39;_sso_token.access_token&#39;)</code> untuk mendapatkan access token dan <code>session()-&gt;get(&#39;_sso_token.refresh_token&#39;)</code>.</p></li></ol></div></div></main><footer class="VPDocFooter" data-v-79ca2460 data-v-04568844><div class="edit-info" data-v-04568844><!----><!----></div><!----></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"index.md\":\"b27521e1\",\"sso-laravel.md\":\"0904de07\",\"sso-php.md\":\"9242e80b\"}")</script>
    <script type="module" async src="/assets/app.c828cd1a.js"></script>
    
  </body>
</html>